####模块划分
```bash
1.cms前台购物系统,类似于淘宝,京东等购物网站
2.cms后台设置系统,提供restful API
```
####日志类
```bash
考虑是否使用自己new对象还是由Nestjs来构造
```
####问题汇总
```bash
1.考虑配置类如何设置 √
2.全局的翻译问题 √
3.session的持久化问题 √
4.jwt授权
5.swagger如何设置defintion
6.swagger的三种授权方式有什么不同,如何授权成功
7.如何使用webpack打包成一个js文件,然后启动部署 √
8.如何启动负载均衡,使用pm2管理,多进程如何启动
9.如何修改某个开源包的源代码,然后发布到自己的git中,然后下载下来使用
10.尝试修改swagger-dist的源代码,使他支持像java中的swagger一样
11.如何反射一个class获取所有的字段或者方法
12.import的导入路径设置别名 √ 因为架构源代码也没有这样设置别名引用,所以本项目也不研究这个问题了。2022-06-21 已经研究出来了
13.POST请求时的响应继承问题 √ 需要使用修饰器注明才能生效
14.登录接口删除凭证的请求头 √ 路由方法中有Headers这个修饰器可以注明请求头入参,但是无法描述说明和key value不一致问题,还是沿用ApiHeader这个修饰器
15.查询用户接口的泛型问题 √ 暂时研究到这里吧,确实无法按照自己所想的那样去实现,有点无奈,主要看test里面的例子即可
16.拦截请求时每次都有一个undefined打印,不知道哪里打印的 √ 解决了,是自己代码继承问题,把参数传进去了,有点坑爹这个源代码
17.如何改变环境变量process.env.NO_COLOR=true就可以解决打印无需颜色 √ 已经解决了
18.了解nest-cli.json的配置文件还有其他什么配置,看看如何webpack打包,如何打包时压缩,如何打包成一个js文件 √ 这里要说一下,nest的主要配置还是看文档cli模块
19.env文件如何改变process的值 √ 已经解决了 关于第18的问题,其实nest默认是使用tsc去编译的,所以认的是tsconfig.build.json的配置
19.5 使用了webpack打包之后,其实认的是webpack.config.js的配置,已经和tsconfig.build.json没有关系了,nest有webpack和tsc两种打包方式
20.不明白为什么@nestjs/config的env环境变量NO_COLOR=true或者false是生效的,自己写的config就是不生效的 √ 不能在ConfigService中改变env,需要在初始化前就改变了
21.需要以后测试每个exports的类是否单例,还有观察他们的内存变化
22.ConfigService可能以后需要支持请求时传入ini可以get set出来使用 √ 这个考虑不做了,直接使用框架包解析ini就可以了
23.需要考虑以后支持抽象类,多种实现类的写法,并且考虑内存,最好是一次请求new,后面直接回收内存
24.如何全局设置拦截XSS攻击 √
25.fileLog日志的写入内容有颜色和格式,需要删除 √ 好像是编译器查看log后缀的文件时自己添加的,没有任何影响
26.如何设置表的别名 √,如何转换表的字段别名 √,如何查出来的_id不是ObjectId, 这个id问题还是自己转吧,似乎都是ObjectId类型的了。测试原项目查询有没有这种现象,还是说返回结果的时候格式化就没了
27.由于引用了ts-path导致测试js-test不认路径了,需要修改 √
28.还是思考生命周期的拦截请求,发现有些时候拦截器太过于后面了,如果在中间件返回去了,那么是拦截不到的,还得思考如何有效拦截全部
29.思考save时的版本异常如何处理,是否需要这个机制??? 后面的修改更新操作的时候需要给版本号加1,然后编辑的时候估计基本都是用save方法了,要不然进不去版本号那个更新判断的
30.似乎使用了request这个令牌后的globalService,只要引用它的服务都不是单例的了
31.需要定义各种异常类
32.可能以后还会考虑开发和生产时的代码里面的路径问题,现在暂时不改了,现在开发也是打包后代码才运行的
33.关于32的问题需要判断不同环境下的启动问题和加载env的问题,打的包里面的路径应该是固定写死的才对 这个问题还是修改webpack的配置即可了
34.考虑如何打包压缩,如何把依赖包打进去,如何加载webpack的动态配置,nest-cli的动态配置等等各种配置的动态配置项,是如何配置的
35.后期把拦截器的内容写到守卫那边去,守卫需要判断权限的操作,必须得拿到session的值
```
####关于权限问题
```bash
以后路由由权限进行控制,代码底层内部尽量少使用权限判断
避免单权限时访问出错
```
####了解技术
```bash
rxjs，sse，socket.io，websocket，
jwt，graphql，typeorm，queues，
cache，fasity，sequelize，microservices
bff，sqru
LRU缓存机制
```
####日常总结
```bash
ts的修饰器分class method params 还有class的字段4种类型
并且从下到上覆盖相同属性值,也就是说写在第一个的属性才是有效值
参数从右往左实例化,字段和方法按上往下实例化,也就是写在前面的先执行,最后到class
```
####关于环境变量
```bash
在jest-e2e.json中加入这段代码改变环境变量,暂未实验
 //  "globals": {
 //    "NODE_ENV":"test"
 //  }
关于configService的测试结果
1.确实可以修改env环境的变量
2.测试发现只要读过文件,再次读取文件时,如果有同名的key会覆盖上一次的结果,说明无法独立内存
```
####2022-05-15后期计划
```bash
-1.e2e测试完毕没有退出,查原因,回退代码看看之前的会不会退出,如果退出看看如何配置退出 √
0.写好config的测试代码,e2e测试,写好config的validate,validationSchema,validationOptions代码
1.新增连接数据库代码 √
2.新增拦截器逻辑 √
3.新增jwt
4.实现登陆登出,session的使用 √
5.拦截异常的统一返回 √
6.过滤请求体,到实现类是不含其它字段 √
7.注解校验字段,可翻译返回 √
8.数据库的读写分离
```
####2022-06-08后期计划
```bash
1.完成登录逻辑,测试登录登出
2.实现jwt
3.实现oas3授权,反正授权二选一,我建议使用oas3
4.新增事件触发器,新增定时器,健康检查,权限访问
```
